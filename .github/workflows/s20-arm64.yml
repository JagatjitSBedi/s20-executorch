name: S20 ARM64 .pte
on: [push]
jobs:
  arm64:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: ARM64 PyTorch
      uses: uraimo/run-on-arch-action@v2
      with:
        arch: aarch64
        distro: ubuntu22.04
        run: |
          apt-get update -qq
          apt-get install -y python3 python3-pip
          pip3 install --no-cache-dir torch --index-url https://download.pytorch.org/whl/cpu
          pip3 install --no-cache-dir executorch[export] transformers
          python3 -c "
import torch
print('PyTorch', torch.__version__)
import executorch
print('ExecuTorch OK')
          from transformers import AutoTokenizer, AutoModelForCausalLM
          from executorch.exir_server import ExirServer
          model_id = 'deepseek-ai/DeepSeek-Coder-V2-Lite-Instruct'
          print('Loading', model          "
